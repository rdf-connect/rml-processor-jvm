@prefix xsd: <http://www.w3.org/2001/XMLSchema#>.
@prefix sosa: <http://www.w3.org/ns/sosa/>.
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>.
@prefix sh: <http://www.w3.org/ns/shacl#>.
@prefix rdfc: <https://w3id.org/rdf-connect#>.
@prefix owl: <http://www.w3.org/2002/07/owl#>.

rdfc:javaImplementationOf rdfs:subPropertyOf rdfs:subClassOf.
#
rdfc:JvmRunner a rdfc:Runner;
  rdfc:handlesSubjectsOf rdfc:javaImplementationOf;
  rdfc:command "[ -f jvm-runner.jar ] || curl -L -o jvm-runner.jar https://javadoc.jitpack.io/com/github/rdf-connect/jvm-runner/runner/master-SNAPSHOT/runner-master-SNAPSHOT-all.jar; java -jar jvm-runner.jar";
  rdfc:processor_definition <JavaProcessorShape>.

[ ] a sh:NodeShape;
  sh:targetSubjectsOf rdfc:javaImplementationOf;
  sh:property [
    sh:path rdfc:jar;
    sh:name "jar";
    sh:minCount 1;
    sh:maxCount 1;
    sh:datatype xsd:string;
  ], [
    sh:path rdfc:class;
    sh:name "clazz";
    sh:minCount 1;
    sh:maxCount 1;
    sh:datatype xsd:string;
  ].

<> owl:imports <../build/libs/rml-processor-0.0.1-all.jar>.
# 
<> owl:imports <./node_modules/@rdfc/file-utils-processors-ts/processors.ttl>.

<> owl:imports <./node_modules/@rdfc/js-runner/index.ttl>.
#
<> a rdfc:Pipeline;
  rdfc:consistsOf [
    rdfc:instantiates rdfc:JvmRunner;
    rdfc:processor <mapper>;
  ], [
    rdfc:instantiates rdfc:NodeRunner;
    rdfc:processor <mappingReader>, <dataReader>, <logger>;
  ].

<foobarRunner> a rdfc:Runner.
<foobar> a rdfc:Runner.
<mappingData> a rdfc:Reader, rdfc:Writer.
<mappingReader> a rdfc:GlobRead;
  rdfc:glob <./mapping.ttl>;
  rdfc:output <mappingData>;
  rdfc:closeOnEnd "true".

<data> a rdfc:Reader, rdfc:Writer.
<dataReader> a rdfc:GlobRead;
  rdfc:glob <./data.json>;
  rdfc:output <data>;
  rdfc:closeOnEnd "true".

<default> a rdfc:Reader, rdfc:Writer.
<mapper> a rdfc:RmlMapper;
  rdfc:mappings <mappingData>;
  rdfc:source [
    rdfc:triggers true;
    rdfc:reader <data>;
    rdfc:mappingId rdfc:source1;
  ];
  rdfc:target [
    rdfc:writer <target1>;
    rdfc:format "trig";
    rdfc:mappingId rdfc:target1;
  ];
  rdfc:defaultTarget [
    rdfc:writer <default>;
    rdfc:format "trig";
  ].

<logger> a <Log>;
  rdfc:input <default>, <target1>.

<Log> a owl:Class, rdfs:Class;
  rdfc:jsImplementationOf rdfc:Processor;
  rdfs:label "Log Things";
  rdfs:comment "Logs things";
  rdfc:file <./logger.js>;
  rdfc:class "Logger";
  rdfc:entrypoint <./>.

[ ] a sh:NodeShape;
  sh:targetClass <Log>;
  sh:property [
    sh:name "streams";
    sh:path rdfc:input;
    sh:class rdfc:Reader;
  ].

